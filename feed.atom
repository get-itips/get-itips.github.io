<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
	<link rel="self" href="https://get-itips.capazero.net/" />
	<id>https://get-itips.capazero.net/</id>
	<title>Andrés Gorzelany</title>
	<rights>2018</rights>
	<updated>2018-02-23T19:45:27Z</updated>
	<subtitle>Microsoft Solution Architect</subtitle>
	<entry>
		<link href="https://get-itips.capazero.net/posts/open-office-fiasco" />
		<id>https://get-itips.capazero.net/posts/open-office-fiasco</id>
		<title>The Open Office Space is a fiasco</title>
		<updated>2018-02-22T00:00:00Z</updated>
		<content>&lt;p&gt;This time I took the liberty of talking about something that it is not IT related, but it is work related, here it goes:&lt;/p&gt;
&lt;p&gt;Some years now, we saw a new trend in offices, &amp;quot;let's remove the cubicles&amp;quot;, &amp;quot;let's remove the walls&amp;quot;, &amp;quot;this way, we can be more productive&amp;quot;.
Ok, the intention was good but, as a consultant that visits many companies I observed (and suffered) some things about this.&lt;/p&gt;
&lt;p&gt;First of all, you feel in a jungle, you hear multiple people talking, even on top of your own voice in your head, you loose focus if you need to concentrate, in this jungle, you will find people that is either yelling to someone on the phone, listening to their favourite music, making jokes to their partner or whatever that does not have anything to do with your job, so you maybe start to use headphones, a thing that is not always possible in every situation or if it is, the people on the office will surely start to think that you have some kind of social relationship problem, &amp;quot;hey, here comes that weird solo-guy&amp;quot;&lt;/p&gt;
&lt;p&gt;Another thing that happens in this jungle is constant interruption of your work: &amp;quot;hey, didn't send you an email because I saw you that we were in the same floor, please stop what you are doing right now and see my big little problem, come on, I also brought to you my notebook to your desk&amp;quot;&lt;/p&gt;
&lt;p&gt;Why? why office designers did you have to do this? did you even work in an office before? did you experience your great idea before releasing it to the world? or are you testing the beta version of it?&lt;/p&gt;
&lt;p&gt;I am not saying that we must return to the cubicle maze, but hey, let's find something in between of that, maybe we can have a more classic area and an open area in the same building so people can choose where they are more productive.&lt;/p&gt;
&lt;p&gt;My two cents on this. I really want to know what is your opinion&lt;/p&gt;
</content>
		<summary>&lt;p&gt;This time I took the liberty of talking about something that it is not IT related, but it is work related, here it goes:&lt;/p&gt;</summary>
	</entry>
	<entry>
		<link href="https://get-itips.capazero.net/posts/call-failed" />
		<id>https://get-itips.capazero.net/posts/call-failed</id>
		<title>Call failed to establish due to a media connectivity failure when both endpoints are...</title>
		<updated>2017-07-21T00:00:00Z</updated>
		<content>&lt;p&gt;internal&lt;br /&gt;
external&lt;br /&gt;
or one endpoint is internal and the other is federated or remote...&lt;/p&gt;
&lt;p&gt;any situation will do.&lt;/p&gt;
&lt;p&gt;This was happening to me on an On-Premise deployment of Skype For Business (Front end and Edge Server) calling to Unified Messaging contact on Exchange Online.&lt;/p&gt;
&lt;p&gt;ICE Candidate negotiation was happening but eventually no &lt;code&gt;remote-candidates&lt;/code&gt; were negotiated.&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-cmd"&gt;ms-client-diagnostics: 22; reason=&amp;quot;Call failed to establish due to a media connectivity failure when both endpoints are internal&amp;quot;;UserType=&amp;quot;Callee&amp;quot;;MediaType=&amp;quot;audio&amp;quot;;MediaChanBlob=&amp;quot;NetworkErr=no error,ErrTime=0,RTPSeq=0,SeqDelta=0,RTPTime=0,RTCPTime=0,TransptRecvErr=0x0,RecvErrTime=0,TransptSendErr=0x0,SendErrTime=0,InterfacesStall=0x0,InterfacesConnCheck=0x0,MediaTimeout=0,RtcpByeSent=0,RtcpByeRcvd=0,BlobVer=1&amp;quot;;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;So this must be firewall-related, this is almost always firewall-related, it seems first that the NAT was maybe responding with another external IP from de ISP Pool, but that was ok, the rules were correct, we checked and re-rechecked, and after so many hours of troubleshooting with Snooper and Wireshark, we started to look more deeply on the firewall and tried weird things.&lt;/p&gt;
&lt;p&gt;The firewall, a Fortigate one, had a NAT button enabled on the rule, you would say, that is obvious that must be activated... but we tried and deactivated that and... Voilá! we saw the face of god at that moment, it worked, the remote-candidates were negotiated at that moment  (so always be sure that this line is present if you want to know that it is working ok)&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-cmd"&gt;a=remote-candidates:1 65.55.127.80 54860 2 65.55.127.80 54721
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and we lived happily ever after.&lt;/p&gt;
</content>
		<summary>&lt;p&gt;internal&lt;br&gt;
external&lt;br&gt;
or one endpoint is internal and the other is federated or remote...&lt;/p&gt;</summary>
	</entry>
	<entry>
		<link href="https://get-itips.capazero.net/posts/csv-adPerm" />
		<id>https://get-itips.capazero.net/posts/csv-adPerm</id>
		<title>Powershell Script to CSV all AD Permissions for a particular Receive Connector</title>
		<updated>2017-02-08T00:00:00Z</updated>
		<content>&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;Had to do this PS Script for me to troubleshoot a receive connector permissions problem.
This will output to a CSV all permissions assigned to a receive connector, please change the $path and $connector variables to suit your needs&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-powershell"&gt;$path = &amp;quot;E:\path\dumpRights.csv&amp;quot;
$csv = &amp;quot;user,identity,deny,accessrights,extendedrights`r`n&amp;quot;
$connector=&amp;quot;connectorName&amp;quot;
$perms=Get-adpermission $connector

foreach($perm in $perms){
    $perm
    $csv+=$perm.user.RawIdentity+ &amp;quot;,&amp;quot; + $perm.identity.ToString() + &amp;quot;,&amp;quot; + $perm.deny.IsPresent + &amp;quot;,&amp;quot; + $perm.accessrights + &amp;quot;,&amp;quot; + $perm.extendedrights
    $csv +=&amp;quot;`n&amp;quot;
}

$fso = new-object -comobject scripting.filesystemobject
$file = $fso.CreateTextFile($path,$true)
$file.write($csv)
$file.close()
&lt;/code&gt;&lt;/pre&gt;
</content>
		<summary>&lt;p&gt;Hi,&lt;/p&gt;</summary>
	</entry>
	<entry>
		<link href="https://get-itips.capazero.net/posts/handy-handshake" />
		<id>https://get-itips.capazero.net/posts/handy-handshake</id>
		<title>Handy SMTP Handshake for testing with Telnet</title>
		<updated>2017-02-08T00:00:00Z</updated>
		<content>&lt;p&gt;Hi,&lt;/p&gt;
&lt;p&gt;It's always useful to test SMTP service, using Telnet, so these are the commands needed:&lt;/p&gt;
&lt;p&gt;First of all, connect through Command Prompt or Powershell&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-cmd"&gt;Telnet x.x.x.x tcpPort
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;For Example &lt;code&gt;Telnet 10.0.2.1 25&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;You will get a welcome message from SMTP Server, like this one:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;220 exc02.contoso.com Microsoft ESMTP MAIL Service ready at Wed&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;then write sequentially hitting enter at each line what is coloured in green here (no color lines are server responses)&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-code"&gt;EHLO mailtesting
AUTH LOGIN
334 VXNlcm5hbWU6
Y29udG9zb1xhY2NvdW50
334 UGFzc3dvcmQ6
dGhlUGFzc3dvcmQ=
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code class="language-code"&gt;MAIL FROM:
RCPT TO:
DATA
Subject: here comes the test 
This is the email content.
.
250 Queued mail for delivery 
&lt;/code&gt;&lt;/pre&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;strong&gt;Important notes:&lt;/strong&gt;
You have to hit enter twice after subject input.
account name and password are entered Base64 encoded, so first encode that information using for example &lt;a href="https://www.base64encode.org/"&gt;this site.&lt;/a&gt;&lt;/p&gt;
</content>
		<summary>&lt;p&gt;Hi,&lt;/p&gt;</summary>
	</entry>
	<entry>
		<link href="https://get-itips.capazero.net/posts/import-ca-trend-iwsva" />
		<id>https://get-itips.capazero.net/posts/import-ca-trend-iwsva</id>
		<title>How to succesfully import Root CA to Trend IWSVA</title>
		<updated>2016-12-13T00:00:00Z</updated>
		<content>&lt;p&gt;Customer reached me to get help importing Root CA certificate to InterScan Web Security Virtual Appliance,&lt;br /&gt;
from Trend Micro documentation:&lt;/p&gt;
&lt;blockquote class="blockquote"&gt;
&lt;p&gt;&amp;quot;By default, IWSVA acts as a private Certificate Authority (CA) and dynamically generates digital certificates&lt;br /&gt;
that are sent to client browsers to complete a secure passage for HTTPS connections. However, the default CA
is not signed by a well-known (trusted) CA on the Internet.Client browsers always display a certificate
warning every time users access an HTTPS Web site.
Although users can safely ignore the certificate warning, Trend Micro recommends using a signed root certificate for IWSVA.&amp;quot;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;So, if you want your users not to receive a warning from their browsers you have to use, typical,an internal Certification Authority that all client computers trust, for example an Enterprise Windows CA like this was the case.&lt;/p&gt;
&lt;p&gt;So, first of all, I had to export the CA Root Certificate including the Private Key,&lt;br /&gt;
go on and logon the Certification Authority computer:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Go to 'Start' -&amp;gt; 'Run' -&amp;gt; mmc.exe&lt;/li&gt;
&lt;li&gt;Click on 'File' -&amp;gt; 'Add / Remove Snap-in'&lt;/li&gt;
&lt;li&gt;Click the 'Add...' button&lt;/li&gt;
&lt;li&gt;Select 'Certificates' then click 'Add'&lt;/li&gt;
&lt;li&gt;Select 'Computer Account' -&amp;gt; 'Next' -&amp;gt; 'Local Computer' -&amp;gt; 'Finish'&lt;/li&gt;
&lt;li&gt;click 'Close' -&amp;gt; 'OK'&lt;/li&gt;
&lt;li&gt;Expand Certificates -&amp;gt; and click on 'Personal' -&amp;gt; 'Certificates'&lt;/li&gt;
&lt;li&gt;Right click the CA cert and choose 'All Tasks' -&amp;gt; 'Export'&lt;/li&gt;
&lt;li&gt;Click 'Next' -&amp;gt; Select 'Yes, Export the private key' -&amp;gt; 'Next'&lt;/li&gt;
&lt;li&gt;Uncheck all of the options here. PKCS 12 should be the only option available. Click 'Next'&lt;/li&gt;
&lt;li&gt;Give the private key a password of your choice&lt;/li&gt;
&lt;li&gt;Give a filename to save as and click 'Next', then 'Finish'&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Now that you have a .pfx file we will need to use the excellent tool called OpenSSL, as I was using Windows, I used OpenSSL for Windows binaries that you can get here &lt;a href="http://gnuwin32.sourceforge.net/packages/openssl.htm"&gt;http://gnuwin32.sourceforge.net/packages/openssl.htm&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Install it and copy the pfx to your computer.&lt;/p&gt;
&lt;p&gt;start a command prompt or PowerShell and run:&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-cmd"&gt;openssl pkcs12 -in -clcerts -nokeys -out certificate.cer
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;then&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-cmd"&gt;openssl pkcs12 -in -nocerts -out pkey-encrypted.key 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You will end up with two files: certificate.cer and pkey-encrypted.key&lt;/p&gt;
&lt;p&gt;If you import them right into IWSVA console it will fail saying &amp;quot;Root Certificate file is invalid. Try Again&amp;quot;&lt;/p&gt;
&lt;p&gt;This drove me nuts, documentation is not so good, it only says you need to provide a PEM file format,  base54 encoded and RSA based encrypted key, and I was sure I was providing just that...  but wait... after many tries and errors, I read that some systems do not accept anything below this line in public certificate key file:&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-code"&gt;-----BEGIN CERTIFICATE-----
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and this line for the private key file&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-code"&gt;-----BEGIN PRIVATE KEY-----
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;so I tried and deleted everything below that lines on both lines... and it worked! Apparently IWSVA can not handle well ignoring the information that comes there.&lt;/p&gt;
&lt;p&gt;Hope is useful for someone else.&lt;/p&gt;
</content>
		<summary>&lt;p&gt;Customer reached me to get help importing Root CA certificate to InterScan Web Security Virtual Appliance,&lt;br&gt;
from Trend Micro documentation:&lt;/p&gt;</summary>
	</entry>
</feed>